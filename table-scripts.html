<!-- table-scripts.html -->
<script>

  // Add a New Row to the Table
  function addRow() {
      const table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
      const rowCount = table.rows.length;
      const row = table.insertRow(rowCount);

      // Create CR Cell
      const crCell = row.insertCell(0);
      const crInput = document.createElement("input");
      crInput.type = "number";
      crInput.name = `cr${rowCount}`;
      crInput.value = 1;
      crInput.min = 1;
      crInput.max = 20;
      crCell.appendChild(crInput);

      // Create Remove Button
      const removeButton = document.createElement("button");
      removeButton.innerText = "-";
      removeButton.className = "button-remove";
      removeButton.style.display = "inline-block";
      removeButton.style.visibility = "visible";
      removeButton.onclick = function () {
          removeRow(row.rowIndex);
      };
      crCell.appendChild(removeButton);
      
      // Create Killed Cell
      const killedCell = row.insertCell(1);
      const killedInput = document.createElement("input");
      killedInput.type = "number";
      killedInput.name = `killed${rowCount}`;
      killedInput.value = 1;
      killedInput.min = 1;
      killedCell.appendChild(killedInput);

      updateRemoveButtonsVisibility();
  }

  // Remove a Row from the Table
  function removeRow(index) {
      const table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
      table.deleteRow(index - 1); // Adjust for 0-based index
      updateRowIndices();
      updateRemoveButtonsVisibility();
  }

  // Update Row Indices
  function updateRowIndices() {
      const table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
      const rows = table.rows;
      for (let i = 0; i < rows.length; i++) {
          const crInput = rows[i].cells[0].querySelector("input");
          const killedInput = rows[i].cells[1].querySelector("input");
          crInput.name = `cr${i}`;
          killedInput.name = `killed${i}`;
      }
  }

  // Update Visibility of Remove Buttons
  function updateRemoveButtonsVisibility() {
      const table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
      const rowCount = table.rows.length;
      const removeButtons = document.querySelectorAll(".button-remove");

      removeButtons.forEach((button) => {
          button.style.display = rowCount > 1 ? "inline-block" : "none";
      });
  }


    // Reset the Form to Initial State
  function resetForm() {
      // Reset the investigation check value
      const investigationCheck = document.getElementById("investigationCheckDisplay");
      if (investigationCheck) {
          investigationCheck.innerText = 10;
      }

      // Get the table and reset its rows, except the header row
      const table = document.getElementById("inputTable").getElementsByTagName("tbody")[0];
      if (table) {
          while (table.rows.length > 0) {
              table.deleteRow(0);
          }

          // Add the initial row
          const row = table.insertRow(0);

          // Create the CR cell
          const crCell = row.insertCell(0);
          const crInput = document.createElement("input");
          crInput.type = "number";
          crInput.name = "cr0";
          crInput.value = 1;
          crInput.min = 1;
          crInput.max = 20;
          crCell.appendChild(crInput);

          // Create the remove button but don't show it initially
          const removeButton = document.createElement("button");
          removeButton.innerText = "-";
          removeButton.className = "button-remove";
          removeButton.style.display = "none"; // Hide initially
          removeButton.onclick = function () {
              removeRow(1);
          };
          crCell.appendChild(removeButton);

          // Create the Killed cell
          const killedCell = row.insertCell(1);
          const killedInput = document.createElement("input");
          killedInput.type = "number";
          killedInput.name = "killed0";
          killedInput.value = 1;
          killedInput.min = 1;
          killedCell.appendChild(killedInput);
      }

      // Clear the results
      const expectedGold = document.getElementById("expectedGold");
      if (expectedGold) {
          expectedGold.innerHTML = '&nbsp;';
      }

      const diceNotation = document.getElementById("diceNotation");
      if (diceNotation) {
          diceNotation.innerHTML = '&nbsp;';
      }

      const timeDelta = document.getElementById("timeDelta");
      if (timeDelta) {
          timeDelta.innerHTML = '&nbsp;';
      }

      // Update the visibility of the remove buttons
      updateRemoveButtonsVisibility();
  }


</script>
